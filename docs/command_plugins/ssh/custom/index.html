<!DOCTYPE html>
<html lang="en-US" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.57.2" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/docs-dop/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/docs-dop/images/favicon.png" type="image/x-icon" />
    <title>ssh/custom :: DOP Deploment Orchestrator for Puppet</title>
    
    
    <link href="/docs-dop/css/nucleus.css?1567595497" rel="stylesheet">
    <link href="/docs-dop/css/font-awesome.min.css?1567595497" rel="stylesheet">
    <link href="/docs-dop/css/hybrid.css?1567595497" rel="stylesheet">
    <link href="/docs-dop/css/featherlight.min.css?1567595497" rel="stylesheet">
    <link href="/docs-dop/css/perfect-scrollbar.min.css?1567595497" rel="stylesheet">
    <link href="/docs-dop/css/auto-complete.css?1567595497" rel="stylesheet">
    <link href="/docs-dop/css/theme.css?1567595497" rel="stylesheet">
    <link href="/docs-dop/css/hugo-theme.css?1567595497" rel="stylesheet">
    

    <script src="/docs-dop/js/jquery-2.x.min.js?1567595497"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/docs-dop/command_plugins/ssh/custom/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://swisscom.github.io/docs-dop">
  <strong>DOP</strong>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/docs-dop/js/lunr.min.js?1567595497"></script>
<script type="text/javascript" src="/docs-dop/js/auto-complete.js?1567595497"></script>
<script type="text/javascript">
    
        var baseurl = '\/docs-dop\/';
    
</script>
<script type="text/javascript" src="/docs-dop/js/search.js?1567595497"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/docs-dop/plan/" title="Plan" class="dd-item 
        
        
        
        ">
      <a href="/docs-dop/plan/">
          Plan
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/pre_processor/" title="Pre-processor" class="dd-item ">
        <a href="/docs-dop/plan/pre_processor/">
        Pre-processor
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/global_settings/" title="Global Settings" class="dd-item ">
        <a href="/docs-dop/plan/global_settings/">
        Global Settings
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/credentials/" title="Credentials" class="dd-item ">
        <a href="/docs-dop/plan/credentials/">
        Credentials
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/hooks/" title="Hooks" class="dd-item ">
        <a href="/docs-dop/plan/hooks/">
        Hooks
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/infrastructures/" title="Infrastructures" class="dd-item ">
        <a href="/docs-dop/plan/infrastructures/">
        Infrastructures
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/nodes/" title="Nodes" class="dd-item ">
        <a href="/docs-dop/plan/nodes/">
        Nodes
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/configuration/" title="Configuration" class="dd-item ">
        <a href="/docs-dop/plan/configuration/">
        Configuration
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/plan/steps/" title="Steps" class="dd-item ">
        <a href="/docs-dop/plan/steps/">
        Steps
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs-dop/command_plugins/" title="Command Plugins" class="dd-item 
        parent
        
        
        ">
      <a href="/docs-dop/command_plugins/">
          Command Plugins
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/command_plugins/custom/" title="custom" class="dd-item ">
        <a href="/docs-dop/command_plugins/custom/">
        custom
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/command_plugins/ssh/custom/" title="ssh/custom" class="dd-item active">
        <a href="/docs-dop/command_plugins/ssh/custom/">
        ssh/custom
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/command_plugins/ssh/puppet_agent_run/" title="ssh/puppet_agent_run" class="dd-item ">
        <a href="/docs-dop/command_plugins/ssh/puppet_agent_run/">
        ssh/puppet_agent_run
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/command_plugins/winrm/puppet_agent_run/" title="winrm/puppet_agent_run" class="dd-item ">
        <a href="/docs-dop/command_plugins/winrm/puppet_agent_run/">
        winrm/puppet_agent_run
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/command_plugins/overview/" title="Overview" class="dd-item ">
        <a href="/docs-dop/command_plugins/overview/">
        Overview
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs-dop/overview/" title="Overview" class="dd-item 
        
        
        
        ">
      <a href="/docs-dop/overview/">
          Overview
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/overview/about/" title="About" class="dd-item ">
        <a href="/docs-dop/overview/about/">
        About
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs-dop/overview/architecture/" title="Architecture" class="dd-item ">
        <a href="/docs-dop/overview/architecture/">
        Architecture
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/docs-dop/'>DOP Deploment Orchestrator for Puppet</a> > <a href='/docs-dop/command_plugins/'>Command Plugins</a> > ssh/custom
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#plugin-parameters">Plugin Parameters</a></li>
<li><a href="#connector-parameters">Connector Parameters</a></li>
<li><a href="#examples">Examples:</a>
<ul>
<li><a href="#simple-example">Simple Example</a></li>
<li><a href="#complete-example">Complete Example</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>ssh/custom</h1>
          

        




<p>This plugin executes custom commands on every node in the step over ssh.</p>

<table>
<thead>
<tr>
<th>Plugin Name</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>ssh/custom</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<h2 id="plugin-parameters">Plugin Parameters</h2>

<p><h3 id="exec-required">exec (required)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>exec</td>
<td>String</td>
<td>nil</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<p>The command the plugin should execute for every node.

<h3 id="arguments-optional">arguments (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>arguments</td>
<td>String,Hash,Array</td>
<td>&rdquo;&rdquo;</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<p>The arguments for the command. This can be set by a string as an array or
as a hash. All the elements of the hash and the array will be flattened
and joined with a space.</p>

<p>The following examples will result all in the same arguments string:</p>

<pre><code>arguments: &quot;--name foo -s somearg&quot;

arguments:
  '--name': 'foo'
  '-s':
  'somearg':

arguments:
  - '--name foo'
  - '-s'
  - 'somearg'
</code></pre>


<h3 id="env-optional">env (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>arguments</td>
<td>Hash</td>
<td>{ DOP_NODE_FQDN =&gt; fqdn_of_node }</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<p>The environment variables that should be set in the context of the command. Additional
variables can be defined in a hash which will be merged with the default.</p>

<p>Example:</p>

<pre><code>env:
  PATH: '/usr/bin:/bin'
  FOO:  'bar'
</code></pre>


<h3 id="expect-exit-codes-optional">expect_exit_codes (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>expect_exit_codes</td>
<td>&lsquo;All&rsquo;, Fixnum, Array of Fixnum</td>
<td>0</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<p>The exit codes DOPi should expect if the command terminates. If the program
exits with an exit code not listed here, DOPi will mark the run as failed.
The values can be a number, an array of numbers or &lsquo;all&rsquo; for all possible exit
codes. This will replace the current default.

<h3 id="parse-output-optional">parse_output (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>parse_output</td>
<td>Hash</td>
<td>{}</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<p>Here you can define patterns that match against the output of the command plugin
and flag certain lines as errors or warnings. The parse_output key should contain
a hash with two keys, &lsquo;error&rsquo; and &lsquo;warning&rsquo; which each can contain an array of
regular expressions.</p>

<p>To for example flag all lines starting with &ldquo;Error:&rdquo; as errors define:</p>

<pre><code>parse_output:
  error:
    - &quot;^Error&quot;
</code></pre>

<h3 id="fail-on-warning-optional">fail_on_warning (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>fail_on_warning</td>
<td>true,false</td>
<td>false</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<p>Set this to true if you want to threat warnings in the output as errors. This is
useful if the plugin already specifies the parsing patterns but your need to stop
the run on warnings.</p>

</p>

<h2 id="connector-parameters">Connector Parameters</h2>

<h3 id="check-host-key-optional">check_host_key (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>check_host_key</td>
<td>true,false</td>
<td>false</td>
<td>0.12.0</td>
</tr>
</tbody>
</table>

<p>By default the ssh connector  will skip the host key checks. This
means you will be potentially vulnerable to man in the middle attacks. Since
DOPi is designed for the provisioning phase you are working with new nodes and
this will usually not be an issue, however changing keys because nodes get
new provisioned will be.</p>

<h3 id="quiet-optional">quiet (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>quiet</td>
<td>true,false</td>
<td>true</td>
<td>0.1</td>
</tr>
</tbody>
</table>

<p>By default ssh will run in quiet mode and stuff like login banners will not
appear in the output. See the documentation about the &ldquo;-q&rdquo; flag in the ssh
man page for more information about this.</p>

<h3 id="port-optional">port (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>port</td>
<td>Numeric</td>
<td>22</td>
<td>0.10</td>
</tr>
</tbody>
</table>

<p>The port to which ssh should connect</p>

<h3 id="base64-optional">base64 (optional)</h3>

<table>
<thead>
<tr>
<th>Key</th>
<th>Allowed Values</th>
<th>Default</th>
<th>Since Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>base64</td>
<td>true,false</td>
<td>true</td>
<td>0.12</td>
</tr>
</tbody>
</table>

<p>This will encode the command with base64 before it is added to the commandline
for the ssh call. This allows to pass complex multiline scripts to the node.</p>

<p>This option is only here for legacy reasons and has usually no use.</p>



<h2 id="examples">Examples:</h2>

<h3 id="simple-example">Simple Example</h3>

<pre><code>- name &quot;Say Hello World on a node&quot;
  nodes:
    - 'web01.example.com'
  command:
    plugin: 'ssh/custom'
    exec: 'echo'
    arguments: &quot;Hello World&quot;
</code></pre>

<h3 id="complete-example">Complete Example</h3>

<pre><code>- name &quot;Install an RPM on the node&quot;
  nodes:
    - 'web01.example.com'
  command:
    plugin: 'ssh/custom'
    exec: 'yum'
    arguments: 'install -y puppet'
    expect_exit_codes: 0
    fail_on_warning: False
    parse_output:
      error:
        - '^No package puppet available'
</code></pre>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/docs-dop/command_plugins/custom/" title="custom"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/docs-dop/command_plugins/ssh/puppet_agent_run/" title="ssh/puppet_agent_run" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/docs-dop/js/clipboard.min.js?1567595497"></script>
    <script src="/docs-dop/js/perfect-scrollbar.min.js?1567595497"></script>
    <script src="/docs-dop/js/perfect-scrollbar.jquery.min.js?1567595497"></script>
    <script src="/docs-dop/js/jquery.sticky.js?1567595497"></script>
    <script src="/docs-dop/js/featherlight.min.js?1567595497"></script>
    <script src="/docs-dop/js/html5shiv-printshiv.min.js?1567595497"></script>
    <script src="/docs-dop/js/highlight.pack.js?1567595497"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/docs-dop/js/modernizr.custom.71422.js?1567595497"></script>
    <script src="/docs-dop/js/learn.js?1567595497"></script>
    <script src="/docs-dop/js/hugo-learn.js?1567595497"></script>

    <link href="/docs-dop/mermaid/mermaid.css?1567595497" type="text/css" rel="stylesheet" />
    <script src="/docs-dop/mermaid/mermaid.js?1567595497"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

