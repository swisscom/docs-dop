<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.20" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />

    
    <title>Pre-processor</title>
    <link href="https://swisscom.github.io/docs-dop//css/nucleus.css" rel="stylesheet">
    <link href="https://swisscom.github.io/docs-dop//css/font-awesome.min.css" rel="stylesheet">
    <link href="https://swisscom.github.io/docs-dop//css/hybrid.css" rel="stylesheet">
    <link href="https://swisscom.github.io/docs-dop//css/featherlight.min.css" rel="stylesheet">
    <link href="https://swisscom.github.io/docs-dop//css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="https://swisscom.github.io/docs-dop//css/horsey.css" rel="stylesheet">
    <link href="https://swisscom.github.io/docs-dop//css/theme.css" rel="stylesheet">
    <link href="https://swisscom.github.io/docs-dop//css/hugo-theme.css" rel="stylesheet">
    <script src="https://swisscom.github.io/docs-dop//js/jquery-2.x.min.js"></script>
    <style type="text/css">:root #header + #content > #left > #rlblock_left
    {display:none !important;}</style>
    

  </head>
  <body class="" data-url="/docs-dop/plan/pre_processor/">
    
    <nav id="sidebar">
  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://swisscom.github.io/docs-dop">
  <strong>DOP</strong>
</a>

    </div>
    
</div>


  <div class="highlightable">
    <ul class="topics">
      
        
        
          
          
            
          
        
          
          
            
          
        
        
        
          
        
          
        
      
      
      
      

      
      
      
        
          
        
      
      
      

      <li class="dd-item  " data-nav-id="/docs-dop/overview/">
        <a href="/docs-dop/overview/">
          <span>
            
              <b>1. </b>
            
             Overview
            
           </span>
        </a>
        
        <ul>
          
            <li class="dd-item " data-nav-id="/docs-dop/overview/architecture/">
              <a href="/docs-dop/overview/architecture/">
                <span>Architecture     </i></span>
              </a>
            </li>
          
        </ul>
        
      </li>
      
      
      

      
      
      
        
          
        
      
      
      

      <li class="dd-item  parent" data-nav-id="/docs-dop/plan/">
        <a href="/docs-dop/plan/">
          <span>
            
              <b>2. </b>
            
             Plan
            
           </span>
        </a>
        
        <ul>
          
            <li class="dd-item active" data-nav-id="/docs-dop/plan/pre_processor/">
              <a href="/docs-dop/plan/pre_processor/">
                <span>Pre-processor     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs-dop/plan/global_settings/">
              <a href="/docs-dop/plan/global_settings/">
                <span>Global Settings     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs-dop/plan/credentials/">
              <a href="/docs-dop/plan/credentials/">
                <span>Credentials     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs-dop/plan/hooks/">
              <a href="/docs-dop/plan/hooks/">
                <span>Hooks     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs-dop/plan/infrastructures/">
              <a href="/docs-dop/plan/infrastructures/">
                <span>Infrastructures     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs-dop/plan/nodes/">
              <a href="/docs-dop/plan/nodes/">
                <span>Nodes     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs-dop/plan/configuration/">
              <a href="/docs-dop/plan/configuration/">
                <span>Configuration     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs-dop/plan/steps/">
              <a href="/docs-dop/plan/steps/">
                <span>Steps     </i></span>
              </a>
            </li>
          
        </ul>
        
      </li>
      
      
    </ul>
    <hr>
     
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>

        <section id="body">
        <div id="overlay"></div>

        <div class="padding highlightable">

            <div id="top-bar">
              
              <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                  <span id="sidebar-toggle-span">
                      <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                        <i class="fa fa-bars"></i>
                      </a>
                  </span>
                
                <span id="toc-menu"><a href=""><i class="fa fa-list-alt"></i></a></span>
                
                
                  
                  
                  
                    
                    
                <a href="/docs-dop/plan/" itemprop="url"><span itemprop="title">Plan</span></a> <i class="fa fa-angle-right"></i>
                    
                  
                
                <span itemprop="title"> Pre-processor</span>
              </div>
              
                  <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#includes">Includes</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

              

            </div>
            
              <div id="body-inner">
                
                <h1>Pre-processor</h1>
                



<p>The pre-processor is something which only applies if you load plans from a file and
not if you use dop as a library and feed the plan as a hash. The pre-processor renders
the plan before it gets loaded by the parser.</p>

<p>The only feature implemented at the moment is includes, which allows you to split your
plans into multiple files and possible reuse parts between different plans.</p>

<p>In the future this may also be used to do templating, but this is not implemented yet.</p>

<h2 id="includes">Includes</h2>

<p>From DOPi &gt;= 0.16, DOPv &gt;= 0.8 on the DOP plan format supports includes. Before
DOP will parse the plan there is now a preprocessor step which will replace all
&ldquo;include: <file>&rdquo; statements with the content of the file.</p>

<p>Example:</p>

<pre><code>name: 'my_plan'
include: '/etc/dop_deployments/credentials.yaml'
include: '/etc/dop_deployments/infrastructure.yaml'
include: 'nodes.yaml'

steps:
  default:
    include: 'openstack_deploy_steps.yaml'
  patch:
    include: '/etc/dop_deployments/generic_patch_maintenance_steps.yaml'
</code></pre>

<p>The file path can either be a relative or an absolute path. Relative paths mean
that the preprocessor will look for the file relative to the path of the file
which is including it. Included files can itself include files.</p>

<p>The content of the included file will be placed at the position where the include
statement begins with the exact same identation for every line.</p>

<p>It is important to note, that since the pre-processor is running before the YAML
parser, that in case of DOPc all the files must be on the client side. It is not
possible to reference files on the DOPc server side. The DOPc client always has
to send a completely rendered plan to the server.</p>

<p>In order to test the result localy you can show the result of the pre-processor
with the following command:</p>

<pre><code>dopc-client render path/to/my/plan.yaml
</code></pre>


      
      
      </div>
    </div>

    

    <div id="navigation">
        
        
        
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://swisscom.github.io/docs-dop//js/clipboard.min.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/perfect-scrollbar.min.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/perfect-scrollbar.jquery.min.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/jquery.sticky-kit.min.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/featherlight.min.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/html5shiv-printshiv.min.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://swisscom.github.io/docs-dop//js/modernizr.custom.71422.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/learn.js"></script>
    <script src="https://swisscom.github.io/docs-dop//js/hugo-learn.js"></script>
    

  </body>
</html>

